---
layout: post
permalink: /blog/2014-word-to-md.html
title: "Word转Markdown工具"
category: articles
tags: [Jekyll]
---

    kiterunner_t
    TO THE HAPPY FEW

对于工具而言，要顺手才能真正干活。对于大多数文字任务来说，Word是最好的工具。或许以前会觉得那些用UNIX下latex之类的工作写作的人很厉害，可在折腾了一番之后，才发现不是我在用工具，而是工具在用我。如果工具不能带给你方便，那么要工具还有什么用处？虽然用Word写东西的时候很爽，如果需要放到网上去就够呛了。在任何时候，我都想表达这么一个愿望，是我在用工具，而不是工具在玩我。如果一个工具带来的心智负担太大，根本就是一个设计错误。

为了完成这种文档的转换，首先需要完成的是按照文档书写顺序对其进行遍历。可是在我翻了两遍《Word 2007开发人员参考》后，并没有找到直接的方法可以完成这件小事。这里就顺带吐槽一下这些人干的事，整个文档写的真心不咋样。我所希望的文档是这样子的：首先能够清晰的介绍事物的concepts，把这东西用一种文字性的东西描述清楚，最好能有图示比较清晰的展示这种观念；然后再有一些基本的案例，小而精即可；最后才是功能点API的罗列。在这份文档中，我以为“概念”章节会是我想要的，结果却是“分配Range”、“添加控件”之类的具体动作罗列。的确，如果仅仅是需要完成这些任务，那么这样子的介绍很好，可如果要完成不一样的东西，可就头痛了。毕竟每个人的需求不一样，因此，文档就不要把精力放在这种事物上了，可以有FAQ，却不是必须。

目前这份小工具支持的特性以及一些限制条件如下：

* 标题转换，支持从“标题1”到“标题3”。对我来说，到目前为止没有超过3级标题的需求。如果以后有，只能说明写的东西太复杂了，没有必要写出来。
* 代码。代码需要在Word里面使用“无间隔”的样式。
* 列表，支持多级列表，级数没有限制。
* 图片。图片需要指定正确的题注才能进行转换，否则会丢失图片信息。原意是打算让代码去自动从嵌入的Word文档中解析出图片，翻了半天也没再官方的VBA文档中找到有这样子做的方法，就不浪费时间在这上面了。图片需要指定放置的路径，默认在当前路径。
* 表格。很不幸，在我折腾了一番表格的直接转换后，我表示放弃。表格需要自己首先转换成图，并且需要题注，题注的名字为图片名称，后缀为png。即按照图片的规格去转换。（公式和表格处理方式一致，这样子就很不幸，行内公式没法支持。）

目前我常用的也就这些功能，以后有时间和需求再去做。代码也只是满足自己的功能需求，注意普通文本中并没有对特殊字符进行转义，所以可能会得不到你想要的效果。代码参考这里：[https://github.com/kiterunner-t/krt/blob/master/l/pl/word_to_md.pl][1]。


[1]: https://github.com/kiterunner-t/krt/blob/master/l/pl/word_to_md.pl
